<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Foydalanuvchilar</title>
    <link rel="stylesheet" href="./users.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<div class="container">

    <h2>Foydalanuvchilar</h2>

    <div class="filters">
        <input id="search" type="text" placeholder="Qidiruv..." oninput="searchUsers()">
        <select id="filterRole" onchange="applyFilters()">
            <option value="">Role (hammasi)</option>
            <option value="driver">Driver</option>
            <option value="user">User</option>
        </select>

        <select id="filterVerify" onchange="applyFilters()">
            <option value="">Verify holati</option>
            <option value="verified">Tasdiqlangan</option>
            <option value="pending">Kutilmoqda</option>
            <option value="rejected">Rad etilgan</option>
        </select>

        <select id="filterBlocked" onchange="applyFilters()">
            <option value="">Block holati</option>
            <option value="blocked">Blocked</option>
            <option value="active">Active</option>
        </select>

        <button class="btn refresh" onclick="reloadUsers()">Yangilash</button>
        <button class="btn export" onclick="exportExcel()">Export Excel</button>
        <button class="btn export" onclick="exportCSV()">Export CSV</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Ismi</th>
                <th>Telefon</th>
                <th>Hudud</th>
                <th>Role</th>
                <th>Holati</th>
                <th>Amallar</th>
            </tr>
        </thead>
        <tbody id="usersTable"></tbody>
    </table>

    <div class="pagination">
        <button onclick="prevPage()">⬅ Oldingi</button>
        <span id="pageInfo">1 / 1</span>
        <button onclick="nextPage()">Keyingi ➡</button>
    </div>

</div>

<!-- ======================= MODAL ========================= -->

<div id="modal" class="modal">
    <div class="modalContent" id="modalContent">

        <div class="modal-tabs">
            <button id="tabProfile" class="tab active" onclick="openTab('profile')">Profil</button>
            <button id="tabLogs" class="tab" onclick="openTab('logs')">Logs</button>
        </div>

        <!-- PROFILE TAB -->
        <div id="profileTab" class="tabContent active">

            <h3 id="m_fullName"></h3>
            <img id="m_avatar">

            <p><b>Telefon:</b> <span id="m_phone"></span></p>
            <p><b>Mintaqa:</b> <span id="m_region"></span></p>
            <p><b>Tuman:</b> <span id="m_district"></span></p>

            <h4>Mashina ma’lumotlari</h4>
            <p><b>Model:</b> <span id="m_car"></span></p>
            <p><b>Rangi:</b> <span id="m_color"></span></p>
            <p><b>Raqami:</b> <span id="m_number"></span></p>

            <p><b>Holati:</b> <span id="m_status"></span></p>
            <p><b>Balans:</b> <span id="m_balance"></span></p>

        </div>

        <!-- LOGS TAB (hozircha bo‘sh, chunki permission error) -->
        <div id="logsTab" class="tabContent">
            <h3>User Logs</h3>
            <ul id="logsList"></ul>
        </div>

        <button class="btn unblock modalClose" onclick="closeModal()">Yopish</button>
    </div>
</div>

<script src="./users.js" type="module"></script>

</body>
</html>
